<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd">

    <!--
    | Spring-managed instance of Cas20ProxyReceivingTicketValidationFilter.  This setup allows us
    | to configure CAS authentication in the preferred, externalizable way.  (It means we can
    | source configuration settings from the primaryPropertyPlaceholderConfigurer.)
    +-->
    <bean name="ticketValidationFilter" class="org.jasig.cas.client.validation.Cas20ProxyReceivingTicketValidationFilter">
       <property name="serverName" value="${portal.protocol.server.context}" />
       <property name="encodeServiceUrl" value="false" />
       <property name="proxyReceptorUrl" value="${cas.ticketValidationFilter.proxyReceptorUrl:}" />
       <property name="ticketValidator">
           <bean class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator">
               <constructor-arg index="0" value="${cas.ticketValidationFilter.ticketValidator.server}" />
               <property name="proxyCallbackUrl" value="${cas.ticketValidationFilter.ticketValidator.proxyCallbackUrl:}" />
           </bean>
       </property>
       <!--
        | For CAS PGT replication for CAS ClearPass in a clustered uPortal environment.
        | See "Replicating PGT using "proxyGrantingTicketStorageClass" and Distributed Caching" in
        | https://wiki.jasig.org/display/CASC/Configuring+the+Jasig+CAS+Client+for+Java+in+the+web.xml.
        | If CAS ClearPass is not enabled in security.properties, this parameter has no effect.
        +-->
       <property name="proxyGrantingTicketStorage">
           <bean class="org.jasig.cas.client.proxy.EhcacheBackedProxyGrantingTicketStorageImpl" />
       </property>
    </bean>

</beans>
